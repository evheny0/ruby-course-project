<%= form_for [@chapter.creative, @chapter] do |f| %>
  <% if @chapter.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@chapter.errors.count, "error") %> prohibited this chapter from being saved:</h2>

      <ul>
      <% @chapter.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="form-group">
    <%= f.label :title %>
    <%= f.text_field :title, :class => "form-control" %>
  </div>
  <div class="form-group">
    <%= f.label :content %>
    <%= f.text_area :content, :class => "form-control", :rows => 10 %>
  </div>
  <div class="actions">
    <%= f.submit "Save", :class => "btn btn-primary btn-block"  %>
    <%= link_to "Delete", [@creative, @chapter], method: :delete, data: { confirm: 'Are you sure?' } %>
  </div>
<% end %>

<script>
    ($(".well").find('form')).on('submit', function(e) {
        e.preventDefault();
        $.ajax({
            type: 'post',
            url: ($(".well").find('form')).attr('action') + ".json",
            data: ($(".well").find('form')).serialize(),
            success: function (data) {
                showNotification("Saved");
                link = $(".active");
                link.attr("id", data.order);
                link.attr("data-id", data.id);
                children = link.find(".list-group-item-heading").children();
                link.find(".list-group-item-heading").text(data.title);
                link.find(".list-group-item-heading").append(children);
            }
        });
    });
</script>
